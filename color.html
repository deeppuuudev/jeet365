<!-- color.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Color Game - Jeet365</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <script src="js/firebase-config.js"></script>
</head>
<body>
  <header class="header">
    <h1>🎯 Jeet365 - Color Game</h1>
    <nav>
      <a href="dashboard.html">🏠 Dashboard</a>
      <a href="number.html">🔢 Number Game</a>
      <a href="withdraw.html">⬇ Withdraw</a>
      <a href="#" onclick="logout()">🚪 Logout</a>
    </nav>
  </header>

  <section class="game">
    <h2>Choose a Color</h2>
    <p>Each correct color wins 2x your bet</p>
    
    <div class="timer">⏱ Time Left: <span id="timer">30</span>s</div>

    <div class="color-buttons">
      <button class="red" onclick="placeBet('red')">Red</button>
      <button class="green" onclick="placeBet('green')">Green</button>
      <button class="violet" onclick="placeBet('violet')">Violet</button>
    </div>

    <input type="number" id="betAmount" placeholder="Enter Bet Amount (Min 10)">
    <div id="resultBox"></div>
  </section>

  <script>
    let timer = 30;
    let gameInterval;

    function startTimer() {
      gameInterval = setInterval(() => {
        timer--;
        document.getElementById("timer").textContent = timer;
        if (timer === 0) {
          clearInterval(gameInterval);
          showResult();
          setTimeout(() => {
            timer = 30;
            startTimer();
          }, 3000);
        }
      }, 1000);
    }

    function showResult() {
      const colors = ["red", "green", "violet"];
      const random = Math.floor(Math.random() * 10); // 0-9
      let result = "";

      if (random <= 7) {
        // 80% loss logic
        result = colors[Math.floor(Math.random() * 3)];
      } else {
        // 20% win logic (same as last bet if exists)
        result = lastColor || colors[Math.floor(Math.random() * 3)];
      }

      document.getElementById("resultBox").innerHTML = `<p>🔔 Result: <strong style="color:${result}">${result.toUpperCase()}</strong></p>`;
      // TODO: Check user bet, reward or not
    }

    let lastColor = "";

    function placeBet(color) {
      const bet = parseInt(document.getElementById("betAmount").value);
      if (isNaN(bet) || bet < 10) {
        alert("Minimum bet is 10 coins.");
        return;
      }

      // Save bet for checking result later
      lastColor = color;
      document.getElementById("resultBox").innerHTML = `🕒 You selected <strong style="color:${color}">${color.toUpperCase()}</strong> for ${bet} coins.`;
      
      // TODO: Deduct coin from Firebase & store game history
    }

    function logout() {
      auth.signOut().then(() => {
        window.location.href = "login.html";
      });
    }

    startTimer();
  </script>
</body>
</html>
