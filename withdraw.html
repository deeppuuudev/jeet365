<!-- withdraw.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Withdraw Coins - Jeet365</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <script src="js/firebase-config.js"></script>
</head>
<body>
  <header class="header">
    <h1>â¬‡ Withdraw Request</h1>
    <nav>
      <a href="dashboard.html">ğŸ  Dashboard</a>
      <a href="color.html">ğŸ¯ Color Game</a>
      <a href="deposit.html">ğŸ’° Deposit</a>
      <a href="#" onclick="logout()">ğŸšª Logout</a>
    </nav>
  </header>

  <section class="withdraw-section">
    <h2>Request Withdrawal</h2>
    <p>ğŸ“Œ Minimum: 50 Coins</p>

    <input type="number" id="withdrawAmount" placeholder="Enter amount to withdraw">
    <button onclick="requestWithdraw()">Submit Request</button>

    <div id="withdrawMsg" class="status-msg"></div>
  </section>

  <script>
    function logout() {
      auth.signOut().then(() => {
        window.location.href = "login.html";
      });
    }

    firebase.auth().onAuthStateChanged(function(user) {
      if (!user) {
        window.location.href = "login.html";
      }
    });

    function requestWithdraw() {
      const amount = parseInt(document.getElementById("withdrawAmount").value);
      const user = firebase.auth().currentUser;

      if (!amount || amount < 50) {
        document.getElementById("withdrawMsg").innerText = "âŒ Minimum 50 coins required.";
        return;
      }

      db.collection("withdrawals").add({
        uid: user.uid,
        email: user.email,
        amount: amount,
        status: "pending",
        createdAt: firebase.firestore.FieldValue.serverTimestamp()
      }).then(() => {
        document.getElementById("withdrawMsg").innerText = "âœ… Request submitted. Wait for admin approval.";
        document.getElementById("withdrawAmount").value = "";
      }).catch((err) => {
        document.getElementById("withdrawMsg").innerText = "âŒ Error: " + err.message;
      });
    }
  </script>
</body>
</html>
